
float dense1_w[16][62] = {
    {
        0.005519866943359375,
        -0.0154571533203125,
        0.005329132080078125,
        -0.0219573974609375,
        0.049072265625,
        0.0298309326171875,
        0.0011272430419921875,
        0.0099945068359375,
        -0.099365234375,
        0.11065673828125,
        0.0012416839599609375,
        0.001598358154296875,
        0.028594970703125,
        0.08233642578125,
        0.0196075439453125,
        0.09100341796875,
        0.056427001953125,
        0.0379638671875,
        0.0008969306945800781,
        0.005313873291015625,
        -0.08905029296875,
        0.08819580078125,
        0.0003376007080078125,
        0.0038967132568359375,
        -0.0167083740234375,
        -0.04034423828125,
        0.0063934326171875,
        -0.0174102783203125,
        -0.00806427001953125,
        0.015838623046875,
        -0.00014579296112060547,
        -0.01508331298828125,
        -0.034027099609375,
        -0.024383544921875,
        -0.0003631114959716797,
        0.0005731582641601562,
        -0.00576019287109375,
        -0.045867919921875,
        0.0010843276977539062,
        -0.025634765625,
        0.015594482421875,
        0.00801849365234375,
        0.0005917549133300781,
        -0.0008435249328613281,
        -0.08074951171875,
        -0.015716552734375,
        -0.00009799003601074219,
        -0.002132415771484375,
        0.01398468017578125,
        0.0306396484375,
        0.01160430908203125,
        0.018310546875,
        0.05560302734375,
        0.044708251953125,
        0.0008139610290527344,
        0.002094268798828125,
        -0.07318115234375,
        0.075439453125,
        0.00040721893310546875,
        0.003650665283203125,
        0.07769775390625,
        -0.040283203125
    },
    {
        0.0094146728515625,
        -0.000736236572265625,
        0.0133056640625,
        -0.0010986328125,
        -0.0021419525146484375,
        0.007038116455078125,
        0.00017333030700683594,
        0.00787353515625,
        0.00875091552734375,
        -0.00687408447265625,
        -0.00033473968505859375,
        -0.00005537271499633789,
        -0.01422119140625,
        -0.041290283203125,
        -0.00928497314453125,
        -0.0384521484375,
        0.000009298324584960938,
        -0.0005564689636230469,
        -0.00040268898010253906,
        0.00148773193359375,
        0.00763702392578125,
        -0.005695343017578125,
        -0.0009965896606445312,
        0.0014944076538085938,
        -0.00991058349609375,
        -0.01218414306640625,
        0.0075836181640625,
        0.00670623779296875,
        -0.0008945465087890625,
        0.00933074951171875,
        0.00039887428283691406,
        0.0005822181701660156,
        -0.006488800048828125,
        0.009307861328125,
        0.0009694099426269531,
        0.004512786865234375,
        -0.0139007568359375,
        -0.000023603439331054688,
        0.003528594970703125,
        0.00836181640625,
        -0.0036773681640625,
        0.0012922286987304688,
        0.00015556812286376953,
        0.0008826255798339844,
        -0.0018138885498046875,
        0.01409912109375,
        0.0010786056518554688,
        0.0017900466918945312,
        -0.01313018798828125,
        -0.032562255859375,
        -0.0116729736328125,
        -0.035888671875,
        -0.0018358230590820312,
        0.0020961761474609375,
        0.00029778480529785156,
        0.002155303955078125,
        0.00554656982421875,
        0.0014753341674804688,
        -0.00015032291412353516,
        0.00018131732940673828,
        -0.0022449493408203125,
        0.00632476806640625
    },
    {
        0.003650665283203125,
        -0.0023555755615234375,
        0.0018749237060546875,
        -0.004940032958984375,
        -0.01331329345703125,
        -0.0193939208984375,
        -0.00058746337890625,
        0.001560211181640625,
        -0.01021575927734375,
        0.022491455078125,
        -0.0011606216430664062,
        -0.001758575439453125,
        0.01000213623046875,
        0.030792236328125,
        0.0024967193603515625,
        0.026763916015625,
        -0.0093231201171875,
        -0.02197265625,
        -0.0011005401611328125,
        0.0018558502197265625,
        -0.005756378173828125,
        0.011474609375,
        -0.000820159912109375,
        0.003658294677734375,
        -0.01232147216796875,
        -0.03900146484375,
        0.0018949508666992188,
        0.0014286041259765625,
        -0.0274810791015625,
        -0.01849365234375,
        -0.0013475418090820312,
        -0.00026416778564453125,
        -0.00887298583984375,
        -0.01397705078125,
        -0.0006976127624511719,
        -0.0004074573516845703,
        -0.0090789794921875,
        -0.023406982421875,
        0.0022125244140625,
        -0.0116729736328125,
        -0.024017333984375,
        -0.019866943359375,
        -0.0008606910705566406,
        0.00238800048828125,
        -0.01386260986328125,
        -0.01125335693359375,
        -0.0006871223449707031,
        -0.0008845329284667969,
        0.011993408203125,
        0.01166534423828125,
        0.01384735107421875,
        0.011138916015625,
        -0.00917816162109375,
        -0.0198822021484375,
        -0.0007443428039550781,
        0.00244903564453125,
        -0.0016994476318359375,
        0.01418304443359375,
        -0.0007534027099609375,
        0.00396728515625,
        -0.00243377685546875,
        -0.01300811767578125
    },
    {
        -0.0003573894500732422,
        -0.00836181640625,
        0.007328033447265625,
        -0.00943756103515625,
        0.0256500244140625,
        0.03240966796875,
        -0.00209808349609375,
        0.0128326416015625,
        -0.0159759521484375,
        0.0228729248046875,
        -0.0020904541015625,
        -0.0010223388671875,
        -0.0006237030029296875,
        -0.1129150390625,
        0.0014095306396484375,
        -0.097412109375,
        0.0302734375,
        0.040802001953125,
        0.0132293701171875,
        -0.0009975433349609375,
        -0.019744873046875,
        -0.0062713623046875,
        -0.0008802413940429688,
        0.0006799697875976562,
        -0.00013172626495361328,
        -0.052093505859375,
        -0.007595062255859375,
        -0.031890869140625,
        0.01404571533203125,
        0.0276336669921875,
        0.00008720159530639648,
        0.000006198883056640625,
        -0.0079803466796875,
        0.0238037109375,
        0.00006508827209472656,
        -0.000048041343688964844,
        -0.0013093948364257812,
        0.02008056640625,
        -0.00783538818359375,
        -0.0007176399230957031,
        0.02154541015625,
        0.027984619140625,
        0.00034928321838378906,
        -0.0003368854522705078,
        -0.006992340087890625,
        0.0247802734375,
        0.00005614757537841797,
        0.000033974647521972656,
        0.0017385482788085938,
        -0.0986328125,
        0.00312042236328125,
        -0.10760498046875,
        0.0236663818359375,
        0.033721923828125,
        -0.0005021095275878906,
        -0.0013494491577148438,
        -0.01226806640625,
        -0.005584716796875,
        -0.0012836456298828125,
        0.0005784034729003906,
        0.0267791748046875,
        0.015655517578125
    },
    {
        0.005039215087890625,
        -0.0294647216796875,
        0.0056304931640625,
        -0.01232147216796875,
        0.0037384033203125,
        0.037689208984375,
        0.0002875328063964844,
        0.01102447509765625,
        -0.0260772705078125,
        0.036376953125,
        0.00024437904357910156,
        -0.004978179931640625,
        -0.00272369384765625,
        -0.133544921875,
        0.0007724761962890625,
        -0.1246337890625,
        0.026641845703125,
        0.0299835205078125,
        -0.001430511474609375,
        0.0038299560546875,
        -0.001308441162109375,
        -0.038116455078125,
        0.012420654296875,
        -0.00335693359375,
        -0.0088958740234375,
        -0.057708740234375,
        -0.006744384765625,
        -0.0248260498046875,
        0.01007843017578125,
        0.02862548828125,
        -0.0003533363342285156,
        -0.0008907318115234375,
        0.01512908935546875,
        0.033416748046875,
        -0.00003737211227416992,
        0.0003814697265625,
        -0.006744384765625,
        0.0186004638671875,
        -0.0052490234375,
        -0.00815582275390625,
        0.0004286766052246094,
        0.0307159423828125,
        0.0007376670837402344,
        -0.00010854005813598633,
        -0.0036563873291015625,
        0.0181884765625,
        -0.00037598609924316406,
        0.0006680488586425781,
        -0.0013027191162109375,
        -0.1455078125,
        -0.002197265625,
        -0.1368408203125,
        0.015960693359375,
        0.031646728515625,
        -0.00006008148193359375,
        -0.0010843276977539062,
        0.007038116455078125,
        -0.0166168212890625,
        -0.0015544891357421875,
        0.0005035400390625,
        0.00836944580078125,
        0.0090179443359375
    },
    {
        0.005908966064453125,
        -0.007083892822265625,
        0.0058441162109375,
        0.005527496337890625,
        -0.0192413330078125,
        -0.0245513916015625,
        -0.0008883476257324219,
        0.01511383056640625,
        -0.0321044921875,
        0.054473876953125,
        -0.0017881393432617188,
        0.00022780895233154297,
        0.0117340087890625,
        0.09942626953125,
        0.0159149169921875,
        0.0914306640625,
        -0.0172271728515625,
        -0.0341796875,
        -0.0005316734313964844,
        -0.004543304443359375,
        -0.0152130126953125,
        0.04443359375,
        -0.0009670257568359375,
        -0.021240234375,
        -0.01540374755859375,
        -0.04351806640625,
        0.00946807861328125,
        -0.017822265625,
        -0.04339599609375,
        -0.056396484375,
        0.0005030632019042969,
        0.0005812644958496094,
        -0.02691650390625,
        -0.0189208984375,
        0.0005602836608886719,
        -0.000980377197265625,
        -0.007801055908203125,
        -0.02362060546875,
        0.002197265625,
        -0.0073089599609375,
        -0.02655029296875,
        -0.05255126953125,
        0.0005869865417480469,
        0.003078460693359375,
        -0.052947998046875,
        -0.0131378173828125,
        0.0006985664367675781,
        0.0011472702026367188,
        0.00753021240234375,
        0.09033203125,
        0.0102996826171875,
        0.08111572265625,
        -0.004398345947265625,
        -0.04632568359375,
        -0.0007891654968261719,
        0.0063629150390625,
        -0.00954437255859375,
        0.040496826171875,
        -0.0013780593872070312,
        -0.00966644287109375,
        0.0028247833251953125,
        -0.0110321044921875
    },
    {
        -0.005859375,
        0.01313018798828125,
        -0.0029010772705078125,
        0.009063720703125,
        0.13330078125,
        0.11981201171875,
        -0.000751495361328125,
        -0.0016326904296875,
        -0.1605224609375,
        0.1229248046875,
        -0.0002503395080566406,
        -0.0030918121337890625,
        -0.0018024444580078125,
        0.12213134765625,
        -0.0084075927734375,
        0.10638427734375,
        0.1226806640625,
        0.11590576171875,
        0.00045680999755859375,
        0.01207733154296875,
        -0.163818359375,
        0.197021484375,
        0.00028061866760253906,
        -0.00919342041015625,
        0.028717041015625,
        0.1168212890625,
        0.050384521484375,
        0.045989990234375,
        0.1295166015625,
        0.048553466796875,
        0.0007882118225097656,
        -0.004116058349609375,
        -0.1236572265625,
        0.03680419921875,
        0.0006661415100097656,
        0.0025177001953125,
        0.01441192626953125,
        0.044830322265625,
        0.058807373046875,
        0.05523681640625,
        0.11895751953125,
        0.05816650390625,
        0.00164031982421875,
        -0.0028362274169921875,
        -0.1412353515625,
        0.037628173828125,
        0.000583648681640625,
        0.0018463134765625,
        -0.005825042724609375,
        0.0784912109375,
        0.0038852691650390625,
        0.08319091796875,
        0.12005615234375,
        0.1143798828125,
        0.0006093978881835938,
        -0.0014982223510742188,
        -0.16064453125,
        0.189697265625,
        -0.0005002021789550781,
        -0.01495361328125,
        0.14111328125,
        -0.0225372314453125
    },
    {
        -0.0012979507446289062,
        -0.00855255126953125,
        -0.0026187896728515625,
        -0.057647705078125,
        -0.0496826171875,
        0.06787109375,
        -0.0017976760864257812,
        0.003383636474609375,
        0.057403564453125,
        0.06622314453125,
        -0.0018281936645507812,
        0.0014286041259765625,
        -0.0072174072265625,
        -0.52978515625,
        0.0005502700805664062,
        -0.5234375,
        0.001220703125,
        0.07086181640625,
        -0.0011320114135742188,
        0.0038604736328125,
        0.0265960693359375,
        -0.17919921875,
        -0.0013294219970703125,
        -0.0012712478637695312,
        -0.0172119140625,
        -0.2412109375,
        0.003025054931640625,
        -0.09710693359375,
        -0.08502197265625,
        0.0648193359375,
        0.00051116943359375,
        -0.000007271766662597656,
        0.166015625,
        0.03399658203125,
        -0.0006666183471679688,
        0.0003552436828613281,
        -0.0174407958984375,
        0.0865478515625,
        -0.001689910888671875,
        0.0299835205078125,
        -0.0258636474609375,
        0.0504150390625,
        0.0005388259887695312,
        0.0013637542724609375,
        0.054046630859375,
        0.00403594970703125,
        0.0010747909545898438,
        -0.0001138448715209961,
        -0.006130218505859375,
        -0.451904296875,
        0.00371551513671875,
        -0.41259765625,
        0.00003916025161743164,
        -0.00984954833984375,
        0.00011587142944335938,
        0.0013141632080078125,
        0.11248779296875,
        -0.1329345703125,
        0.002582550048828125,
        -0.0012111663818359375,
        -0.026153564453125,
        0.0877685546875
    },
    {
        0.01305389404296875,
        -0.00970458984375,
        0.0159912109375,
        -0.0197601318359375,
        -0.04071044921875,
        -0.05377197265625,
        -0.0022411346435546875,
        0.01702880859375,
        -0.033233642578125,
        0.0682373046875,
        -0.00252532958984375,
        0.001575469970703125,
        0.006778717041015625,
        0.11346435546875,
        0.0192718505859375,
        0.1041259765625,
        -0.0328369140625,
        -0.06500244140625,
        -0.00174713134765625,
        -0.014434814453125,
        -0.004268646240234375,
        0.046844482421875,
        -0.0015382766723632812,
        0.0020389556884765625,
        -0.020721435546875,
        -0.08978271484375,
        0.0146636962890625,
        0.0036296844482421875,
        -0.0706787109375,
        -0.07403564453125,
        0.0003161430358886719,
        0.0027217864990234375,
        -0.03887939453125,
        -0.027099609375,
        -0.0003871917724609375,
        -0.001644134521484375,
        -0.00484466552734375,
        -0.033050537109375,
        0.0231170654296875,
        -0.0031337738037109375,
        -0.061187744140625,
        -0.07952880859375,
        0.0006384849548339844,
        0.0035877227783203125,
        -0.06854248046875,
        -0.01517486572265625,
        0.0007023811340332031,
        0.0002359151840209961,
        0.0196380615234375,
        0.08837890625,
        0.015350341796875,
        0.07562255859375,
        -0.047454833984375,
        -0.06243896484375,
        -0.0015954971313476562,
        -0.016204833984375,
        0.005462646484375,
        0.037384033203125,
        -0.0018186569213867188,
        0.0025653839111328125,
        -0.005710601806640625,
        -0.045196533203125
    },
    {
        0.00640106201171875,
        -0.0015611648559570312,
        0.007587432861328125,
        -0.00830841064453125,
        -0.001415252685546875,
        0.00766754150390625,
        0.0033397674560546875,
        0.0022411346435546875,
        0.01171875,
        0.006557464599609375,
        -0.006519317626953125,
        0.005771636962890625,
        -0.00772857666015625,
        -0.0977783203125,
        -0.0042266845703125,
        -0.0958251953125,
        -0.0041656494140625,
        0.01296234130859375,
        -0.001407623291015625,
        0.0012998580932617188,
        0.003627777099609375,
        -0.0096588134765625,
        -0.0014629364013671875,
        0.00492095947265625,
        -0.0074615478515625,
        -0.033294677734375,
        0.01220703125,
        0.0033740997314453125,
        0.00618743896484375,
        0.01751708984375,
        0.0002791881561279297,
        0.0005946159362792969,
        0.0028667449951171875,
        0.0303802490234375,
        -0.00012743473052978516,
        -0.000060439109802246094,
        -0.0038318634033203125,
        0.0035762786865234375,
        0.01096343994140625,
        0.0125579833984375,
        0.006145477294921875,
        0.0164947509765625,
        0.0003256797790527344,
        0.0008254051208496094,
        0.00086212158203125,
        0.0221405029296875,
        0.00006753206253051758,
        -0.0003368854522705078,
        -0.0080413818359375,
        -0.08203125,
        -0.007793426513671875,
        -0.07989501953125,
        -0.007663726806640625,
        0.00742340087890625,
        0.010711669921875,
        -0.004756927490234375,
        0.013671875,
        0.0010585784912109375,
        -0.0010251998901367188,
        -0.00019943714141845703,
        -0.00519561767578125,
        0.00847625732421875
    },
    {
        -0.0010328292846679688,
        -0.006893157958984375,
        -0.005092620849609375,
        -0.01004791259765625,
        -0.0199737548828125,
        -0.01371002197265625,
        -0.0019311904907226562,
        0.00264739990234375,
        0.03173828125,
        -0.01436614990234375,
        0.01100921630859375,
        -0.0002942085266113281,
        0.0012655258178710938,
        -0.055419921875,
        0.0005249977111816406,
        -0.04608154296875,
        -0.02154541015625,
        -0.015594482421875,
        -0.0006203651428222656,
        0.00025010108947753906,
        0.0228729248046875,
        -0.029388427734375,
        -0.0008268356323242188,
        0.00067901611328125,
        0.0016546249389648438,
        -0.00015163421630859375,
        -0.00560760498046875,
        -0.006526947021484375,
        -0.01311492919921875,
        -0.008758544921875,
        -0.00028228759765625,
        0.0002624988555908203,
        0.006587982177734375,
        0.00467681884765625,
        -0.00019562244415283203,
        -0.006153106689453125,
        0.0012865066528320312,
        0.01262664794921875,
        -0.006549835205078125,
        0.0017709732055664062,
        -0.01241302490234375,
        -0.01015472412109375,
        -0.00036144256591796875,
        0.0010652542114257812,
        0.006702423095703125,
        -0.002140045166015625,
        -0.00009250640869140625,
        -0.0015134811401367188,
        0.0029926300048828125,
        -0.032806396484375,
        0.0016050338745117188,
        -0.028961181640625,
        -0.025665283203125,
        -0.0150299072265625,
        0.0084381103515625,
        -0.0014095306396484375,
        0.0254364013671875,
        -0.0213165283203125,
        -0.00013554096221923828,
        0.0024662017822265625,
        -0.026275634765625,
        0.00885772705078125
    },
    {
        0.0009131431579589844,
        0.00844573974609375,
        -0.0006670951843261719,
        -0.0014944076538085938,
        -0.0184478759765625,
        -0.01190948486328125,
        0.0130462646484375,
        0.00206756591796875,
        0.0257568359375,
        -0.0328369140625,
        -0.0008077621459960938,
        -0.001983642578125,
        0.0021820068359375,
        -0.0274200439453125,
        0.00131988525390625,
        -0.026153564453125,
        -0.0169525146484375,
        -0.0022563934326171875,
        -0.0003147125244140625,
        -0.000042438507080078125,
        0.0256500244140625,
        -0.047882080078125,
        -0.00037789344787597656,
        -0.0013799667358398438,
        0.005035400390625,
        0.0097503662109375,
        -0.0126495361328125,
        -0.00907135009765625,
        -0.0113372802734375,
        0.001934051513671875,
        -0.0007467269897460938,
        -0.00014662742614746094,
        0.01006317138671875,
        0.0006194114685058594,
        -0.00023925304412841797,
        -0.00861358642578125,
        -0.0013790130615234375,
        0.0032062530517578125,
        -0.007720947265625,
        -0.003536224365234375,
        -0.0094146728515625,
        -0.0019502639770507812,
        -0.00032019615173339844,
        0.000007212162017822266,
        0.02294921875,
        0.0016193389892578125,
        -0.0000756382942199707,
        -0.00007814168930053711,
        0.0018215179443359375,
        -0.0201873779296875,
        0.0015325546264648438,
        -0.0078125,
        -0.01580810546875,
        -0.0025653839111328125,
        -0.00034332275390625,
        0.0009140968322753906,
        0.02215576171875,
        -0.033599853515625,
        -0.00011152029037475586,
        0.0007443428039550781,
        -0.0232086181640625,
        0.01155853271484375
    },
    {
        0.00891876220703125,
        -0.009185791015625,
        0.005096435546875,
        -0.0063018798828125,
        0.00647735595703125,
        0.019927978515625,
        0.0018205642700195312,
        0.00344085693359375,
        -0.0021038055419921875,
        0.00937652587890625,
        0.0033588409423828125,
        0.004302978515625,
        -0.0034618377685546875,
        -0.04193115234375,
        -0.0002846717834472656,
        -0.0428466796875,
        0.0136566162109375,
        0.01629638671875,
        0.00679779052734375,
        -0.0021457672119140625,
        -0.004055023193359375,
        -0.014129638671875,
        0.00022995471954345703,
        0.001468658447265625,
        -0.00768280029296875,
        -0.035308837890625,
        -0.006351470947265625,
        -0.0202789306640625,
        0.0010194778442382812,
        0.01568603515625,
        0.00020122528076171875,
        -0.0006437301635742188,
        0.00344085693359375,
        0.007801055908203125,
        -0.0001138448715209961,
        0.001117706298828125,
        -0.006092071533203125,
        -0.00008338689804077148,
        -0.006008148193359375,
        -0.00965118408203125,
        0.003307342529296875,
        0.01305389404296875,
        0.000335693359375,
        -0.0004317760467529297,
        0.0034961700439453125,
        0.00588226318359375,
        0.00017964839935302734,
        0.0011196136474609375,
        -0.0033779144287109375,
        -0.051239013671875,
        -0.00215911865234375,
        -0.051239013671875,
        0.0103607177734375,
        0.0118255615234375,
        0.0006380081176757812,
        -0.00025153160095214844,
        0.00027251243591308594,
        -0.011688232421875,
        0.000026881694793701172,
        0.0009927749633789062,
        0.00653076171875,
        0.0012674331665039062
    },
    {
        0.0021457672119140625,
        -0.00567626953125,
        -0.002208709716796875,
        -0.0025386810302734375,
        -0.0157928466796875,
        0.002288818359375,
        -0.0023136138916015625,
        -0.0030765533447265625,
        0.01192474365234375,
        0.0012159347534179688,
        0.0002856254577636719,
        -0.004863739013671875,
        0.0027713775634765625,
        -0.07354736328125,
        0.004291534423828125,
        -0.06353759765625,
        -0.00891876220703125,
        -0.00537109375,
        0.016357421875,
        -0.003246307373046875,
        0.01120758056640625,
        -0.0257568359375,
        -0.00055694580078125,
        0.0018873214721679688,
        -0.00521087646484375,
        -0.033966064453125,
        -0.00629425048828125,
        -0.0162506103515625,
        -0.01078033447265625,
        0.0099029541015625,
        -0.00008279085159301758,
        -0.0001728534698486328,
        0.00848388671875,
        0.007053375244140625,
        0.00006431341171264648,
        -0.0004096031188964844,
        -0.004596710205078125,
        0.0114898681640625,
        -0.004535675048828125,
        -0.0118560791015625,
        -0.0107574462890625,
        0.01203155517578125,
        -0.00029158592224121094,
        0.0008168220520019531,
        0.0132293701171875,
        0.002208709716796875,
        -0.0005636215209960938,
        -0.0005435943603515625,
        0.0014705657958984375,
        -0.05511474609375,
        0.00362396240234375,
        -0.05560302734375,
        -0.01280975341796875,
        0.006412506103515625,
        -0.0019321441650390625,
        -0.0010690689086914062,
        0.01428985595703125,
        -0.020538330078125,
        -0.0009102821350097656,
        0.002826690673828125,
        -0.008758544921875,
        0.0094146728515625
    },
    {
        0.0017681121826171875,
        -0.002567291259765625,
        0.00884246826171875,
        -0.0010690689086914062,
        -0.034820556640625,
        -0.0046539306640625,
        -0.0012054443359375,
        -0.005451202392578125,
        0.040130615234375,
        0.00518798828125,
        -0.0007448196411132812,
        0.006938934326171875,
        0.00002771615982055664,
        -0.119384765625,
        0.0025653839111328125,
        -0.1285400390625,
        -0.0293426513671875,
        -0.0294189453125,
        -0.0008683204650878906,
        0.0012311935424804688,
        0.016326904296875,
        -0.0404052734375,
        0.01348114013671875,
        -0.0027751922607421875,
        -0.025177001953125,
        -0.090576171875,
        0.0197296142578125,
        0.003444671630859375,
        -0.019134521484375,
        -0.01395416259765625,
        0.00016510486602783203,
        0.00013566017150878906,
        0.04766845703125,
        0.031646728515625,
        -0.0000851750373840332,
        -0.000823974609375,
        -0.0125885009765625,
        -0.00986480712890625,
        0.01212310791015625,
        0.025604248046875,
        -0.02545166015625,
        0.0004210472106933594,
        0.00008207559585571289,
        0.0006155967712402344,
        0.039306640625,
        0.0170745849609375,
        0.0001652240753173828,
        -0.00012946128845214844,
        0.0009541511535644531,
        -0.1129150390625,
        0.0021419525146484375,
        -0.10479736328125,
        -0.037506103515625,
        -0.029571533203125,
        -0.0007958412170410156,
        0.000675201416015625,
        0.025909423828125,
        -0.0263214111328125,
        -0.0010919570922851562,
        -0.0016202926635742188,
        -0.0318603515625,
        0.0215301513671875
    },
    {
        0.01470947265625,
        -0.007160186767578125,
        0.0171661376953125,
        -0.016204833984375,
        -0.00009113550186157227,
        0.03167724609375,
        0.004428863525390625,
        0.00928497314453125,
        -0.0093536376953125,
        0.0200042724609375,
        0.0039520263671875,
        0.007610321044921875,
        -0.0092620849609375,
        -0.1396484375,
        -0.007678985595703125,
        -0.132080078125,
        0.005054473876953125,
        0.023101806640625,
        -0.0021343231201171875,
        0.0038967132568359375,
        -0.0010023117065429688,
        -0.0261077880859375,
        -0.0016841888427734375,
        0.0020542144775390625,
        -0.01593017578125,
        -0.07086181640625,
        0.00994110107421875,
        -0.01119232177734375,
        0.006923675537109375,
        0.008880615234375,
        0.000005543231964111328,
        0.0000979304313659668,
        -0.003635406494140625,
        0.0298309326171875,
        0.00003975629806518555,
        0.0005593299865722656,
        -0.00809478759765625,
        0.01313018798828125,
        0.01248931884765625,
        0.01094818115234375,
        -0.0049896240234375,
        0.01151275634765625,
        0.0005192756652832031,
        0.000904083251953125,
        0.006687164306640625,
        0.04180908203125,
        -0.00007641315460205078,
        8.344650268554688e-7,
        -0.01074981689453125,
        -0.137939453125,
        -0.00408935546875,
        -0.1297607421875,
        -0.004787445068359375,
        0.0168914794921875,
        -0.0006170272827148438,
        0.0011987686157226562,
        0.0030193328857421875,
        -0.00453948974609375,
        0.002635955810546875,
        -0.00213623046875,
        -0.01123046875,
        0.01363372802734375
}};
float dense1_b[16] = {
    -1.7607421875,
    -0.66748046875,
    0.0994873046875,
    -1.48828125,
    -1.3193359375,
    -0.58349609375,
    -1.203125,
    1.5107421875,
    -0.438720703125,
    -0.9404296875,
    -1.3837890625,
    -0.7626953125,
    -1.9619140625,
    -1.12890625,
    -1.220703125,
    -1.2568359375
};
float dense2_w[6][16] = {
    {
        0.5146484375,
        -0.91259765625,
        0.451171875,
        -0.0196990966796875,
        0.120849609375,
        0.1373291015625,
        -0.76611328125,
        -0.18701171875,
        0.336181640625,
        -0.53271484375,
        -0.1656494140625,
        -0.2493896484375,
        -0.404052734375,
        -0.2269287109375,
        -0.310302734375,
        -0.51611328125
    },
    {
        -0.11297607421875,
        0.4091796875,
        0.69873046875,
        -0.41845703125,
        -0.36767578125,
        0.62548828125,
        -0.45166015625,
        -0.213623046875,
        -0.469970703125,
        -0.25390625,
        -0.22802734375,
        -0.263427734375,
        0.07147216796875,
        -0.263671875,
        -0.1544189453125,
        -0.26708984375
    },
    {
        -0.2044677734375,
        0.32470703125,
        -0.67724609375,
        -0.418701171875,
        -0.300048828125,
        0.241943359375,
        -0.01267242431640625,
        -0.732421875,
        0.3828125,
        -0.269775390625,
        -0.499267578125,
        -0.78076171875,
        -0.03582763671875,
        -0.55908203125,
        -0.148193359375,
        -0.297607421875
    },
    {
        -0.0106658935546875,
        -0.007114410400390625,
        -0.1505126953125,
        0.63916015625,
        0.71142578125,
        0.2015380859375,
        0.0118560791015625,
        0.54541015625,
        -0.029754638671875,
        0.448974609375,
        0.61865234375,
        0.634765625,
        0.30615234375,
        0.51025390625,
        0.2196044921875,
        0.12371826171875
    },
    {
        0.430419921875,
        -0.44140625,
        0.41015625,
        -0.152587890625,
        -0.2880859375,
        0.3095703125,
        0.65869140625,
        0.1534423828125,
        0.52392578125,
        -0.1378173828125,
        -0.05902099609375,
        -0.1763916015625,
        -0.3935546875,
        -0.1376953125,
        -0.431884765625,
        -0.413330078125
    },
    {
        -0.031524658203125,
        0.17333984375,
        -0.2171630859375,
        0.406005859375,
        0.338623046875,
        0.050048828125,
        -0.090087890625,
        0.63671875,
        0.0545654296875,
        0.1788330078125,
        0.34033203125,
        0.408935546875,
        0.436767578125,
        0.33984375,
        0.488525390625,
        0.31787109375
    }
};
float dense2_b[6] = {
    0.2052001953125,
    0.1915283203125,
    0.278076171875,
    0.11474609375,
    0.3486328125,
    0.1766357421875
};
float dense3_w[2][6] = {
    {
        -0.87890625,
        0.00795745849609375,
        -1.01171875,
        0.0731201171875,
        -0.52197265625,
        0.70556640625
    },
    {
        0.349365234375,
        1.5595703125,
        -0.1856689453125,
        -0.71435546875,
        0.80322265625,
        -0.96875
    }
};
float dense3_b[2] = {
    -0.2227783203125,
    0.2227783203125
};

#include <stdio.h>
#include <stdint.h>
#include <math.h>

// 定义联合体，用于存储两个float32
union TwoFloat16 {
    uint32_t data;
    struct {
        uint32_t sign_bit1 : 1;      // 符号位
        uint32_t exponent1 : 1;      // 指数位
        uint32_t fraction1 : 14;    // 第一个浮点数的小数位
        uint32_t sign_bit2 : 1;      // 符号位
        uint32_t exponent2 : 1;      // 指数位
        uint32_t fraction2 : 14;    // 第二个浮点数的小数位
    } parts;
};

void printBytes(uint32_t value, int bytes) {
    // 用位运算获取二进制表示
    for (int i = bytes-1; i >= 0; i--) {
        uint32_t mask = 1 << i;
        uint32_t bit = (value & mask) ? 1 : 0;
        printf("%d", bit);
    }
}

// 将两个float32转换为一个TwoFloat16
void convertToTwoFloat16(float input1, float input2, union TwoFloat16 *output) {
    // 初始化output
    output->parts.sign_bit1 = 0;
    output->parts.sign_bit2 = 0;
    output->parts.exponent1 = 0;
    output->parts.exponent2 = 0;

    // 处理第一个输入浮点数
    if (input1 < 0) {
        output->parts.sign_bit1 = 1;  // 设置符号位
        input1 = -input1;            // 取绝对值
    }

    if (input1 > 0.999999999) {
        output->parts.exponent1 = 1;
        input1 -= 1.;
    }
    
    //output->parts.fraction1 = (uint32_t)(input1 * 16384);  // 将小数部分乘以16384来获得14位的小数位
    float cur = 1;
    output->parts.fraction1 = 0;
    uint32_t bias = 1<<13;
    for(int i=0;i<14;i++) {
        cur /= 2.;
        if(input1 > cur) {
            input1 -= cur;
            output->parts.fraction1 += bias;
        }
        bias >>= 1;
    }
    
    // 处理第二个输入浮点数
    if (input2 < 0) {
        output->parts.sign_bit2 = 1;  // 设置符号位
        input2 = -input2;            // 取绝对值
    }

    if (input2 > 0.999999999) {
        output->parts.exponent2 = 1;
        input2 -= 1.;
    }

    //output->parts.fraction2 = (uint32_t)(input2 * 16384);  // 将小数部分乘以16384来获得14位的小数位
    cur = 1;
    output->parts.fraction2 = 0;
    bias = 1<<13;
    for(int i=0;i<14;i++) {
        cur /= 2.;
        if(input2 > cur) {
            input2 -= cur;
            output->parts.fraction2 += bias;
        }
        bias >>= 1;
    }

    /*
    printBytes(output->data, 32);
    putchar('\n');
    printf("%u\n", output->data);
    getchar();
    */
}

void dequant(const union TwoFloat16 input, float *output1, float *output2){
    *output1 = 0.;
    *output2 = 0.;

    uint32_t mask = 1<<13;
    float cur = 1.;
    for(int i=0;i<14;i++) {
        cur /= 2.0;
        if(mask & input.parts.fraction1) {
            *output1 = *output1 + cur;
        }
        mask >>= 1;
    }

    mask = 1<<13;
    cur = 1.;
    for(int i=0;i<14;i++) {
        cur /= 2.0;
        if(mask & input.parts.fraction2) {
            *output2 = *output2 + cur;
        }
        mask >>= 1;
    }

    //*output1 = (float)input.parts.fraction1 / 16384;
    //*output2 = (float)input.parts.fraction2 / 16384;
    if(input.parts.exponent1) {
        *output1 += 1.0;
    }
    if(input.parts.exponent2) {
        *output2 += 1.0;
    }
    if(input.parts.sign_bit1) {
        *output1 = -(*output1);
    }
    if(input.parts.sign_bit2) {
        *output2 = -(*output2);
    }
}

void validate() {

    float input1 = -1.234364;  // 替换为你的第一个浮点数
    float input2 = 0.3446664;  // 替换为你的第二个浮点数

    union TwoFloat16 result;

    // 调用转换函数，将两个float32转换为一个TwoFloat16
    convertToTwoFloat16(input1, input2, &result);
    float ans1, ans2;
    dequant(result, &ans1, &ans2);
    printf("%f -> %f\n%f -> %f (%d)\n", input1, ans1, input2, ans2, result.data);

}

void convert1(const char* name, const float* src, uint32_t row, uint32_t col) {
    printf("const union TwoFloat16 %s[%d][%d] = {", name, row, col/2);
    if(col & 1 != 0) {
        printf("Error!");
        exit(1);
    }
    col /= 2;
    for(int i=0;i<row;i++) {
        for(int j=0;j<col;j++) {
            union TwoFloat16 dest;
            convertToTwoFloat16(*(src+i*col*2+2*j), *(src+i*col*2+2*j+1), &dest);
            printf("0x%x,", dest.data);
        }
    }
    printf("\b};\n");
}

void convert2(const char* name, const float* src, uint32_t row) {
    printf("const union TwoFloat16 %s[%d] = {", name, row/2);
    if(row & 1 != 0) {
        printf("Error!");
        exit(1);
    }
    row /= 2;
    for(int i=0;i<row;i++) {
        union TwoFloat16 dest;
        convertToTwoFloat16(*(src+2*i), *(src+2*i+1), &dest);
        printf("0x%x,", dest.data);
    }
    printf("\b};\n");
}

int main() {
    // You can run this func to validate
    //validate();
    //0.529785 0.197021
    float max_v = -999;
    float min_v = 999;
    float max_abs = -999;
    for(int i=0;i<16;++i) {
        for(int j=0;j<62;++j) {
            if(dense1_w[i][j] > max_v) {
                max_v = dense1_w[i][j];
            }
            if(dense1_w[i][j] < min_v) {
                min_v = dense1_w[i][j];
            }
            dense1_w[i][j] *= 3.75;
            if(fabs(dense1_w[i][j]) > max_abs) {
                max_abs = fabs(dense1_w[i][j]);
            }
        }
    }

    //printf("%f\n", 4./(max_v-min_v));
    //printf("%f\n", max_abs);
    //return 0;

    convert1("dense1_wq", dense1_w, 16, 62);
    convert2("dense1_bq", dense1_b, 16);
    convert1("dense2_wq", dense2_w, 6, 16);
    convert2("dense2_bq", dense2_b, 6);
    convert1("dense3_wq", dense3_w, 2, 6);
    convert2("dense3_bq", dense3_b, 2);

    return 0;
}
